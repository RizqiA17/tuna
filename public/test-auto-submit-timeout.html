<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Auto-Submit Timeout</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .timer-display {
            font-size: 24px;
            font-weight: bold;
            color: #e74c3c;
            text-align: center;
            margin: 10px 0;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .status.success { background-color: #d4edda; color: #155724; }
        .status.error { background-color: #f8d7da; color: #721c24; }
        .status.warning { background-color: #fff3cd; color: #856404; }
        .status.info { background-color: #d1ecf1; color: #0c5460; }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background-color: #0056b3; }
        button:disabled { background-color: #6c757d; cursor: not-allowed; }
        .log {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ§ª Test Auto-Submit Timeout Feature</h1>
        <p>Test untuk memverifikasi fitur auto-submit ketika timer habis.</p>

        <div class="test-section">
            <h3>Timer Test (5 detik)</h3>
            <div class="timer-display" id="timerDisplay">5:00</div>
            <button onclick="startTestTimer(5)">Start 5 Second Timer</button>
            <button onclick="stopTestTimer()">Stop Timer</button>
            <button onclick="clearLog()">Clear Log</button>
        </div>

        <div class="test-section">
            <h3>Status</h3>
            <div id="timerStatus" class="status info">Ready to test</div>
            <div id="autoSubmitStatus" class="status info">Waiting for auto-submit</div>
        </div>

        <div class="test-section">
            <h3>Test Log</h3>
            <div id="testLog" class="log">Test log will appear here...</div>
        </div>

        <div class="test-section">
            <h3>Test Instructions</h3>
            <ol>
                <li>Klik "Start 5 Second Timer" untuk memulai timer 5 detik</li>
                <li>Timer akan countdown dari 5 detik ke 0</li>
                <li>Ketika timer mencapai 0, sistem akan otomatis memanggil auto-submit</li>
                <li>Periksa log untuk melihat proses auto-submit</li>
                <li>Status akan berubah menjadi "Auto-submit triggered" ketika timer habis</li>
            </ol>
        </div>
    </div>

    <script>
        let testTimeLeft = 5;
        let testTimer = null;
        let testTimerStartTime = null;

        function log(message) {
            const logElement = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${timestamp}] ${message}<br>`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        function showStatus(elementId, type, message) {
            const element = document.getElementById(elementId);
            element.className = `status ${type}`;
            element.textContent = message;
        }

        function startTestTimer(duration = 5) {
            testTimeLeft = duration;
            testTimerStartTime = Date.now();
            
            log(`Starting timer for ${duration} seconds`);
            showStatus('timerStatus', 'info', `Timer started for ${duration} seconds`);
            
            // Start the timer
            testTimer = setInterval(() => {
                testTimeLeft--;
                updateTimerDisplay();
                log(`Timer tick: ${testTimeLeft} seconds remaining`);
                
                if (testTimeLeft <= 0) {
                    stopTestTimer();
                    log('Timer expired! Triggering auto-submit...');
                    showStatus('timerStatus', 'warning', 'Timer expired!');
                    showStatus('autoSubmitStatus', 'warning', 'Auto-submit triggered!');
                    
                    // Simulate auto-submit call
                    simulateAutoSubmit();
                }
            }, 1000);
            
            updateTimerDisplay();
            document.getElementById('timerDisplay').style.display = 'block';
        }

        function stopTestTimer() {
            if (testTimer) {
                clearInterval(testTimer);
                testTimer = null;
                log('Timer stopped manually');
            }
            testTimeLeft = 0;
            testTimerStartTime = null;
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(testTimeLeft / 60);
            const seconds = testTimeLeft % 60;
            const display = `${minutes}:${seconds.toString().padStart(2, "0")}`;
            document.getElementById('timerDisplay').textContent = display;
        }

        function simulateAutoSubmit() {
            log('Simulating auto-submit with timeout response...');
            
            // Simulate the auto-submit data that would be sent
            const autoSubmitData = {
                position: 1,
                decision: "[TIMEOUT] - Tim tidak mengirim jawaban dalam waktu yang ditentukan",
                argumentation: "[TIMEOUT] - Jawaban otomatis karena waktu habis"
            };
            
            log(`Auto-submit data: ${JSON.stringify(autoSubmitData, null, 2)}`);
            
            // Simulate API call delay
            setTimeout(() => {
                log('Auto-submit API call completed');
                showStatus('autoSubmitStatus', 'success', 'Auto-submit completed successfully!');
                log('âœ… Auto-submit feature is working correctly!');
            }, 1000);
        }

        function clearLog() {
            document.getElementById('testLog').innerHTML = 'Test log cleared...<br>';
            showStatus('timerStatus', 'info', 'Ready to test');
            showStatus('autoSubmitStatus', 'info', 'Waiting for auto-submit');
        }

        // Initialize
        log('Auto-submit timeout test initialized');
        log('This test simulates the auto-submit feature when timer expires');
    </script>
</body>
</html>
